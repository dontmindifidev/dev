<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Discount Codes</title>
</head>
<body>
    <h1>Discount Code Generator</h1>

    <form id="discountForm">
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate" name="startDate" required>
        <br><br>
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate" name="endDate" required>
        <br><br>
        <label for="partner">Partner Code (2 characters):</label>
        <input type="text" id="partner" name="partner" maxlength="2" required>
        <br><br>
        <button type="submit">Generate Codes</button>
    </form>

    <h2>Generated Discount Codes:</h2>
    <div id="output"></div>

    <script>
        function generateCode(date, partner) {
            if (!(date instanceof Date)) {
                console.error('The first argument must be a Date object');
                return;
            }

            if (typeof partner !== 'string' || partner.length !== 2) {
                console.error('The second argument must be a string of length 2');
                return;
            }

            const year = date.getFullYear().toString().slice(-2); // Get the last two digits of the year
            const month = ('0' + (date.getMonth() + 1)).slice(-2); // Get the month as a two-digit number
            const partnerCode = partner.toUpperCase(); // Ensure the partner code is uppercase

            // Generate a random 4-character string (letters and numbers)
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let randomString = '';
            for (let i = 0; i < 4; i++) {
                randomString += chars.charAt(Math.floor(Math.random() * chars.length));
            }

            // Combine all parts to form the discount code
            const discountCode = `${year}${month}${partnerCode}${randomString}`;
            
            return discountCode;
        }

        function getMonthlyCodes(startDate, endDate, partner) {
            let codes = [];
            let currentDate = new Date(startDate);

            while (currentDate <= endDate) {
                codes.push(generateCode(currentDate, partner));
                // Move to the next month
                currentDate.setMonth(currentDate.getMonth() + 1);
                // Ensure the day of the month remains valid
                if (currentDate.getDate() !== startDate.getDate()) {
                    currentDate.setDate(0);
                }
            }

            return codes;
        }

        document.getElementById('discountForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            const startDateInput = document.getElementById('startDate').value;
            const endDateInput = document.getElementById('endDate').value;
            const partnerInput = document.getElementById('partner').value;

            const startDate = new Date(startDateInput);
            const endDate = new Date(endDateInput);

            if (startDate > endDate) {
                document.getElementById('output').innerText = 'End date must be after start date.';
                return;
            }

            const codes = getMonthlyCodes(startDate, endDate, partnerInput);
            document.getElementById('output').innerText = codes.join('\n');
        });
    </script>
</body>
</html>